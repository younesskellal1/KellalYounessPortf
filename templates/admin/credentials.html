{% extends "admin/base.html" %}

{% block page_title %}Admin Credentials{% endblock %}

{% block content %}
<div class="credentials-management">
    <div class="page-header">
        <h2>Admin Credentials Management</h2>
        <p>Change your admin username and password</p>
    </div>

    {% if admin_info %}
    <div class="info-card">
        <h3>Account Information</h3>
        <div class="info-grid">
            <div class="info-item">
                <label>Username:</label>
                <span>{{ admin_info.username }}</span>
            </div>
            <div class="info-item">
                <label>Account Created:</label>
                <span>{{ admin_info.created_at or 'N/A' }}</span>
            </div>
            <div class="info-item">
                <label>Last Login:</label>
                <span>{{ admin_info.last_login or 'Never' }}</span>
            </div>
        </div>
    </div>
    {% endif %}

    <div class="credentials-forms">
        <!-- Change Password Form -->
        <div class="form-card">
            <h3>Change Password</h3>
            <form method="POST" action="{{ url_for('admin_credentials') }}">
                <input type="hidden" name="action" value="change_password">
                
                <div class="form-group">
                    <label for="current_password">Current Password</label>
                    <input type="password" id="current_password" name="current_password" required>
                </div>
                
                <div class="form-group">
                    <label for="new_password">New Password</label>
                    <input type="password" id="new_password" name="new_password" required minlength="6">
                    <small>Password must be at least 6 characters long</small>
                </div>
                
                <div class="form-group">
                    <label for="confirm_password">Confirm New Password</label>
                    <input type="password" id="confirm_password" name="confirm_password" required minlength="6">
                </div>
                
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-key"></i>
                    Update Password
                </button>
            </form>
        </div>

        <!-- Change Username Form -->
        <div class="form-card">
            <h3>Change Username</h3>
            <form method="POST" action="{{ url_for('admin_credentials') }}">
                <input type="hidden" name="action" value="change_username">
                
                <div class="form-group">
                    <label for="new_username">New Username</label>
                    <input type="text" id="new_username" name="new_username" required minlength="3" 
                           value="{{ admin_info.username if admin_info else '' }}">
                    <small>Username must be at least 3 characters long</small>
                </div>
                
                <div class="form-group">
                    <label for="password_verify">Current Password (for verification)</label>
                    <input type="password" id="password_verify" name="password" required>
                </div>
                
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-user-edit"></i>
                    Update Username
                </button>
            </form>
        </div>
    </div>
</div>

<style>
.credentials-management {
    padding: 20px;
}

.page-header {
    margin-bottom: 30px;
}

.page-header h2 {
    margin: 0 0 5px 0;
    color: var(--color-text);
}

.page-header p {
    color: var(--color-text-secondary);
    margin: 0;
}

.info-card {
    background: var(--color-card);
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 30px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.info-card h3 {
    margin: 0 0 15px 0;
    color: var(--color-text);
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.info-item label {
    font-weight: 600;
    color: var(--color-text-secondary);
    font-size: 0.9em;
}

.info-item span {
    color: var(--color-text);
    font-size: 1.1em;
}

.credentials-forms {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 30px;
}

.form-card {
    background: var(--color-card);
    border-radius: 8px;
    padding: 25px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.form-card h3 {
    margin: 0 0 20px 0;
    color: var(--color-text);
    padding-bottom: 15px;
    border-bottom: 2px solid var(--color-border);
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--color-text);
}

.form-group input {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--color-border);
    border-radius: 6px;
    font-size: 1em;
    background: var(--color-bg);
    color: var(--color-text);
    box-sizing: border-box;
}

.form-group input:focus {
    outline: none;
    border-color: var(--color-accent);
}

.form-group small {
    display: block;
    margin-top: 5px;
    color: var(--color-text-secondary);
    font-size: 0.85em;
}

@media (max-width: 768px) {
    .credentials-forms {
        grid-template-columns: 1fr;
    }
    
    .info-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

